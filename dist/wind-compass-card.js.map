{"version":3,"file":"wind-compass-card.js","sources":["../src/wind-compass-card.ts"],"sourcesContent":[null],"names":["console","info","WindCompassCard","HTMLElement","constructor","this","_bucketSize","_bucketCount","_warnMultiplier","_historyData","_lastHistoryFetch","_currentUnit","_maxSpeed","_currentGust","_limitRaffstore","_limitRollo","hass","content","card","document","createElement","style","padding","display","flexDirection","gap","innerHTML","appendChild","resizeObserver","ResizeObserver","_updateDimensions","_updateVisuals","observe","Array","fill","map","duration","totalSpeed","entityDirAvg","config","direction_entity","entityDirInst","instant_direction_entity","entitySpeed","speed_entity","entityGust","gust_entity","entityLimitRaffstore","raffstore_limit_entity","entityLimitRollo","rollo_limit_entity","maxSpeed","max_speed","undefined","warn_multiplier","parseFloat","String","reqBucketSize","bucket_size","parseInt","isNaN","finalBucketSize","Math","floor","dirStateAvg","states","dirStateInst","speedState","gustState","_avgDeg","state","_instDeg","_currentSpeed","attributes","unit_of_measurement","now","Date","_fetchHistory","dirEntity","speedEntity","endTime","startTime","getTime","entities","join","history","callApi","toISOString","length","dirHist","find","arr","entity_id","speedHist","_processHistoryData","e","error","dirData","speedData","buckets","speedIdx","i","nextState","deg","startTs","last_changed","durationMin","currentSpeedState","speedVal","bucketIndex","_pxPerDeg","tape","querySelector","offset","transform","marker","diff","speedBar","gustBar","speedText","limitRaff","limitRollo","pct","width","pctGust","html","p","left","container","offsetWidth","_buildTape","activeLimits","push","minLimit","min","alertThreshold","maxDur","maxBucketAvgSpeed","forEach","b","avg","slotWidth","barWidth","max","pxPos","normalizedDeg","data","avgSpeed","isCritical","usedColor","bar","className","heightPct","height","borderTopColor","background","opacity","freqRatio","tick","drawTick","label","text","innerText","top","setConfig","Error","getCardSize","customElements","define","window","customCards","type","name","preview","description"],"mappings":"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"}