{"version":3,"file":"wind-compass-card.js","sources":["../src/wind-compass-card.ts"],"sourcesContent":[null],"names":["console","info","WindCompassCard","HTMLElement","constructor","this","_bucketSize","_bucketCount","_warnMultiplier","_historyData","_lastHistoryFetch","_avgDeg","_instDeg","_currentUnit","_maxSpeed","_currentGust","_limitRaffstore","_limitRollo","getConfigElement","document","createElement","getStubConfig","type","direction_entity","instant_direction_entity","speed_entity","gust_entity","max_speed","hass","_hass","_updateCard","setConfig","config","Error","_recalcBuckets","reqBucketSize","undefined","bucket_size","Number","isNaN","Math","floor","Array","fill","map","duration","totalSpeed","connectedCallback","shadowRoot","attachShadow","mode","_render","content","querySelector","_resizeObserver","ResizeObserver","_updateDimensions","_updateVisuals","observe","disconnectedCallback","disconnect","innerHTML","dirEntity","instantDirEntity","speedEntity","entityGust","entityLimitRaff","raffstore_limit_entity","entityLimitRollo","rollo_limit_entity","warn_multiplier","dirState","states","instDirState","speedState","gustState","parseFloat","state","_currentSpeed","attributes","unit_of_measurement","now","Date","_fetchHistory","endTime","startTime","getTime","entities","join","history","callApi","toISOString","length","dirHist","find","arr","entity_id","speedHist","_processHistoryData","e","error","dirData","speedData","buckets","speedIdx","i","deg","startTs","last_changed","durationMin","speedVal","bucketIndex","container","width","offsetWidth","_pxPerDeg","_buildTape","tape","maxDur","maxBucketAvgSpeed","forEach","b","avg","limits","filter","l","minLimit","min","alertThreshold","slotWidth","barWidth","max","pxPos","normalizedDeg","data","avgSpeed","isCritical","usedColor","bar","className","heightPct","style","height","left","borderTopColor","background","opacity","freqRatio","toString","appendChild","drawTick","tick","label","directions","textContent","top","transform","marker","diff","speedBar","gustBar","speedText","limitRaff","limitRollo","pct","pctGust","html","round","p","display","getCardSize","customElements","define"],"mappings":"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"}